<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 3 Categorical data | Introduction to Statistics: an integrated textbook and workbook using R</title>
<meta name="author" content="Sean Raleigh, Westminster College (Salt Lake City, UT)">
<meta name="description" content="h5{font-size:2em;color:#0000FF}h6{font-size:1.5em;color:#0000FF}div.answer{margin-left:5%;border:1px solid #0000FF;border-left-width:10px;padding:25px}...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Chapter 3 Categorical data | Introduction to Statistics: an integrated textbook and workbook using R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://vectorposse.github.io/intro_stats/categorical.html">
<meta property="og:description" content="h5{font-size:2em;color:#0000FF}h6{font-size:1.5em;color:#0000FF}div.answer{margin-left:5%;border:1px solid #0000FF;border-left-width:10px;padding:25px}...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 3 Categorical data | Introduction to Statistics: an integrated textbook and workbook using R">
<meta name="twitter:description" content="h5{font-size:2em;color:#0000FF}h6{font-size:1.5em;color:#0000FF}div.answer{margin-left:5%;border:1px solid #0000FF;border-left-width:10px;padding:25px}...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet">
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Introduction to Statistics: an integrated textbook and workbook using R</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Introduction</a></li>
<li><a class="" href="intror.html"><span class="header-section-number">1</span> Introduction to R</a></li>
<li><a class="" href="rmark.html"><span class="header-section-number">2</span> Using R Markdown</a></li>
<li><a class="active" href="categorical.html"><span class="header-section-number">3</span> Categorical data</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/VectorPosse/intro_stats">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="categorical" class="section level1" number="3">
<h1>
<span class="header-section-number">3</span> Categorical data<a class="anchor" aria-label="anchor" href="#categorical"><i class="fas fa-link"></i></a>
</h1>
<!-- Please don't mess with the next few lines! -->
<style>h5{font-size:2em;color:#0000FF}h6{font-size:1.5em;color:#0000FF}div.answer{margin-left:5%;border:1px solid #0000FF;border-left-width:10px;padding:25px} div.summary{background-color:rgba(30,144,255,0.1);border:3px double #0000FF;padding:25px}</style>
<p style="color:#ffffff">
2.0
</p>
<!-- Please don't mess with the previous few lines! -->
<div id="functions-introduced-in-this-chapter-2" class="section level3 unnumbered summary">
<h3>Functions introduced in this chapter:<a class="anchor" aria-label="anchor" href="#functions-introduced-in-this-chapter-2"><i class="fas fa-link"></i></a>
</h3>
<p><code>glimpse</code>, <code>table</code>, <code>tabyl</code>, <code>adorn_pct_formatting</code>, <code>ggplot</code>, <code>geom_bar</code>, <code>adorn_percentages</code>, <code>mutate</code>, <code>as_factor</code>, <code>labs</code>, <code>tibble</code>, <code>geom_col</code></p>
</div>
<div id="categorical-intro" class="section level2" number="3.1">
<h2>
<span class="header-section-number">3.1</span> Introduction<a class="anchor" aria-label="anchor" href="#categorical-intro"><i class="fas fa-link"></i></a>
</h2>
<p>In this chapter, we’ll learn about categorical data and how to summarize it using tables and graphs.</p>
</div>
<div id="categorical-download" class="section level2" number="3.2">
<h2>
<span class="header-section-number">3.2</span> Download the R notebook file<a class="anchor" aria-label="anchor" href="#categorical-download"><i class="fas fa-link"></i></a>
</h2>
<p>Check the upper-right corner in RStudio to make sure you’re in your <code>intro_stats</code> project. Then click on the following link to download this chapter as an R notebook file (<code>.Rmd</code>).</p>
<p><a href="https://vectorposse.github.io/intro_stats/chapter_downloads/03-categorical_data.Rmd" download>https://vectorposse.github.io/intro_stats/chapter_downloads/03-categorical_data.Rmd</a></p>
<p>Once the file is downloaded, move it to your project folder in RStudio and open it there.</p>
</div>
<div id="categorical-restart" class="section level2" number="3.3">
<h2>
<span class="header-section-number">3.3</span> Restart R and run all chunks<a class="anchor" aria-label="anchor" href="#categorical-restart"><i class="fas fa-link"></i></a>
</h2>
<p>In RStudio, in the toolbar above this document, find the “Run” drop-down menu and select “Restart R and Run All Chunks.”</p>
<p>This does two important things:</p>
<ol style="list-style-type: decimal">
<li>R will restart. This will clear out the Global Environment and provide a fresh session for this new assignment. None of the clutter from previous chapters will be there to mess up your work in this chapter.</li>
<li>All the code chunks in this document will run so that you can see the output as you scroll past it. This saves you some effort in having to click the little green “Run” button in each code chunk as you come across it. (Also, if you forget to run one, that could cause errors later on, so this way, all the variables you need will be in the Global Environment for when they’re needed later.) You will still need to click the green arrow for new code chunks that you create, of course.</li>
</ol>
<p>At the end of the assignment, you will “Restart R and Run All Chunks” once again to make sure that everything works smoothly and there are no lingering errors.</p>
</div>
<div id="categorical-load" class="section level2" number="3.4">
<h2>
<span class="header-section-number">3.4</span> Load packages<a class="anchor" aria-label="anchor" href="#categorical-load"><i class="fas fa-link"></i></a>
</h2>
<p>We load the <code>tidyverse</code> package since it also loads the <code>ggplot2</code> package that we’ll use throughout the course to make graphs. It also loads several other packages, for example, one called <code>dplyr</code> to give us a command called <code>mutate</code>, and another called <code>forcats</code> to give us <code>as_factor</code>. (These will all be explained later.) The <code>janitor</code> package gives us the <code>tabyl</code> command for creating nice tables. Finally, We load the <code>palmerpenguins</code> package to work with the penguin data.</p>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Attaching package: 'janitor'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     chisq.test, fisher.test</code></pre>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://allisonhorst.github.io/palmerpenguins/">palmerpenguins</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div id="categorical-data" class="section level2" number="3.5">
<h2>
<span class="header-section-number">3.5</span> Categorical data<a class="anchor" aria-label="anchor" href="#categorical-data"><i class="fas fa-link"></i></a>
</h2>
<p>Data comes in different types depending on what is being measured. When people think of “data”, they often imagine <em>numerical data</em>, consisting of numbers. But there are other kinds of data as well.</p>
<p>In this chapter, we focus on <em>categorical data</em> that groups observations into categories.</p>
<p>For example, if we record the species of a penguin, that is not a number. It’s a word that classifies that penguin into one of a finite number of types. Whenever you see words in a data set, there’s a good chance that you’re looking at categorical data.</p>
<p>Even “numbers” can sometimes represent categorical data. For example, suppose in a survey there is a Yes/No question. Instead of seeing the words “Yes” or “No”, though, you might see a data set with ones and zeros, where 1 = Yes and 0 = No. The presence of numbers does not automatically make that data numerical. In fact, the data is categorical. Yes and No are categories that sort the survey respondents into two groups based on their responses to a certain question.</p>
<p>What about ZIP codes? They are recorded as numbers, and unlike the Yes/No example above, those numbers aren’t just substitutes for words. Nevertheless, ZIP codes are categorical. They sort addresses into a finite number of groups based on geographic proximity.</p>
<p>Another way to think of it is this: can the numerical values of ZIP codes be treated as numbers in any meaningful way? Can you take a sum or an average of ZIP codes? Sure, technically a computer can add up or average a set of ZIP codes, but would the result be a meaningful number? Since the answer is “no” we cannot think of ZIP codes as numbers, even though they are recorded that way.</p>
<div id="exercise-1" class="section level5 unnumbered">
<h5>Exercise 1<a class="anchor" aria-label="anchor" href="#exercise-1"><i class="fas fa-link"></i></a>
</h5>
<p>Think of another type of data that would be recorded using numbers but should be thought of as categorical data.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
</div>
<div id="categorical-factor" class="section level2" number="3.6">
<h2>
<span class="header-section-number">3.6</span> Factor variables<a class="anchor" aria-label="anchor" href="#categorical-factor"><i class="fas fa-link"></i></a>
</h2>
<p>R uses the term “factor variable” to refer to a categorical variable. Look at the structure of the <code>penguins</code> data below.</p>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html">str</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code>## tibble [344 × 8] (S3: tbl_df/tbl/data.frame)
##  $ species          : Factor w/ 3 levels "Adelie","Chinstrap",..: 1 1 1 1 1 1 1 1 1 1 ...
##  $ island           : Factor w/ 3 levels "Biscoe","Dream",..: 3 3 3 3 3 3 3 3 3 3 ...
##  $ bill_length_mm   : num [1:344] 39.1 39.5 40.3 NA 36.7 39.3 38.9 39.2 34.1 42 ...
##  $ bill_depth_mm    : num [1:344] 18.7 17.4 18 NA 19.3 20.6 17.8 19.6 18.1 20.2 ...
##  $ flipper_length_mm: int [1:344] 181 186 195 NA 193 190 181 195 193 190 ...
##  $ body_mass_g      : int [1:344] 3750 3800 3250 NA 3450 3650 3625 4675 3475 4250 ...
##  $ sex              : Factor w/ 2 levels "female","male": 2 1 1 NA 1 2 1 2 NA NA ...
##  $ year             : int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
<p>The categorical variables <code>species</code>, <code>island</code>, and <code>sex</code> are coded correctly as factor variables.</p>
<p>The <code>tidyverse</code> package offers a function called <code>glimpse</code> that effectively does the same thing as <code>str</code>. We’ll use <code>glimpse</code> throughout the rest of the course.</p>
<div class="sourceCode" id="cb63"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 344
## Columns: 8
## $ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
## $ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
## $ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
## $ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
## $ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
## $ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
## $ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
## $ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
<div id="exercise-2" class="section level5 unnumbered">
<h5>Exercise 2<a class="anchor" aria-label="anchor" href="#exercise-2"><i class="fas fa-link"></i></a>
</h5>
<p>Look at the output of <code>str</code> versus <code>glimpse</code> above. Write down any advantages or disadvantages you see using one versus the other. (You may also want to check the help file for the two commands to see if they offer any clues as to why you might use one over the other.)</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>Your data set may already come with its variables coded correctly as factor variables, but often they are not. As described above, numbers are often used to represent categories, so R may think that those variables represent numerical data. Later, we’ll see an example of this and learn how to handle categorical variables that are not coded as factor variables in R.</p>
</div>
</div>
<div id="categorical-summarizing-one" class="section level2" number="3.7">
<h2>
<span class="header-section-number">3.7</span> Summarizing one categorical variable<a class="anchor" aria-label="anchor" href="#categorical-summarizing-one"><i class="fas fa-link"></i></a>
</h2>
<p>If you need to summarize a single categorical variable, a <em>frequency table</em> usually suffices. This is simply a table that counts up all the instances of each category. The word “frequency” is synonymous here with the word “count”.</p>
<p>We can use the <code>table</code> command:</p>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">species</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
##    Adelie Chinstrap    Gentoo 
##       152        68       124</code></pre>
<p>Recall that the dollar sign means to grab the variable <code>species</code> from the tibble <code>penguins</code>.</p>
<p>You can also generate a <em>relative frequency table</em> which is a table that uses proportions or percentages instead of counts.</p>
<p><strong>NOTE:</strong> For purposes of this course, we’re going to be very careful about the terms <em>proportion</em> and <em>percentage</em>. For us, a proportion will always be a number between 0 and 1 whereas a percentage will be between 0 and 100. Calculating a percentage is the same as multiplying a proportion by 100.</p>
<p>The <code>table</code> command stops being convenient if you want proportions instead of counts. Instead, we will use the <code>tabyl</code> command from the <code>janitor</code> package that was loaded near the top of the chapter. The syntax for this command is a little different. The tibble goes first, followed by a comma, followed by the variable you want to summarize:</p>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="va">species</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["int"],"align":["right"]},{"label":["percent"],"name":[3],"type":["dbl"],"align":["right"]}],"data":[{"1":"Adelie","2":"152","3":"0.4418605"},{"1":"Chinstrap","2":"68","3":"0.1976744"},{"1":"Gentoo","2":"124","3":"0.3604651"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Now you get both counts and proportions. Note that in the output above, it’s a little misleading to call the last column “percent”. These are actually proportions, and we would have to multiply by 100 to get percentages.</p>
<p>If you really want percentages, we can use an <code>adorn</code> function to get them as follows:</p>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["fct"],"align":["left"]},{"label":["n"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["percent"],"name":[3],"type":["chr"],"align":["left"]}],"data":[{"1":"Adelie","2":"152","3":"44.2%"},{"1":"Chinstrap","2":"68","3":"19.8%"},{"1":"Gentoo","2":"124","3":"36.0%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>The syntax above looks a little confusing with the unusual <code>%&gt;%</code> there. You will learn more about that weird set of symbols in a later chapter. For now, you can just copy and paste this code and make any necessary changes to the tibble and/or variables names as needed.</p>
<div id="exercise-3a" class="section level5 unnumbered">
<h5>Exercise 3(a)<a class="anchor" aria-label="anchor" href="#exercise-3a"><i class="fas fa-link"></i></a>
</h5>
<p>Use the <code>tabyl</code> command as above to create a frequency table for the sex of the penguins. (You will also get a relative frequency table for free.)</p>
<div class="answer">
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to create a frequency table for sex</span></span></code></pre></div>
</div>
</div>
<div id="exercise-3b" class="section level5 unnumbered">
<h5>Exercise 3(b)<a class="anchor" aria-label="anchor" href="#exercise-3b"><i class="fas fa-link"></i></a>
</h5>
<p>In the table for sex that you just created, what does the last row mean?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
<div id="exercise-3c" class="section level5 unnumbered">
<h5>Exercise 3(c)<a class="anchor" aria-label="anchor" href="#exercise-3c"><i class="fas fa-link"></i></a>
</h5>
<p>Now create a relative frequency table for sex that reports percentages and not proportions.</p>
<div class="answer">
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here that reports percentages instead of proportions</span></span></code></pre></div>
</div>
</div>
<div id="exercise-3d" class="section level5 unnumbered">
<h5>Exercise 3(d)<a class="anchor" aria-label="anchor" href="#exercise-3d"><i class="fas fa-link"></i></a>
</h5>
<p>In the previous tables, what is the difference between <code>percent</code> and <code>valid_percent</code>? Why are there two different sets of percentages being computed?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
</div>
<div id="categorical-graphing-one" class="section level2" number="3.8">
<h2>
<span class="header-section-number">3.8</span> Graphing one categorical variable<a class="anchor" aria-label="anchor" href="#categorical-graphing-one"><i class="fas fa-link"></i></a>
</h2>
<p>When asked, “What type of graph should I use when graphing a single categorical variable?” the simple answer is “None.” If you do need to summarize a categorical variable, a frequency table usually suffices.</p>
<p>If you really, really want a graph, the standard type is a bar chart. But before we can create one, we need to start learning about the very important tool we will use throughout the course for graphing. It’s called <code>ggplot</code> and it’s part of a package called <code>ggplot2</code>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Why the “2”? It’s a long story. Google it if you’re interested in the history of the development of the &lt;code&gt;ggplot2&lt;/code&gt; package.&lt;/p&gt;"><sup>6</sup></a></p>
<p>We don’t have to load the <code>ggplot2</code> package explicitly because it got loaded alongside a number of other packages when we called <code><a href="https://tidyverse.tidyverse.org">library(tidyverse)</a></code> early on in the chapter.</p>
</div>
<div id="categorical-ggplot" class="section level2" number="3.9">
<h2>
<span class="header-section-number">3.9</span> ggplot<a class="anchor" aria-label="anchor" href="#categorical-ggplot"><i class="fas fa-link"></i></a>
</h2>
<p>The <code>ggplot</code> command is an all-purpose graphing utility. It uses a graphing philosophy derived from a book called <em>The Grammar of Graphics</em> by Leland Wilkinson. The basic idea is that each variable you want to plot should correspond to some element or “aesthetic” component of the graph. The obvious places for data to go are along the y-axis or x-axis, but other aesthetics are important too; graphs often use color, shape, or size to illustrate different aspects of data. Once these aesthetics have been defined, we will add “layers” to the graph. These are objects like dots, boxes, lines, or bars that dictate the type of graph we want to see.</p>
<p>In an introductory course, we won’t get too fancy with these graphs. But be aware that there’s a whole field of data visualization that studies clear and interesting ways to understand data graphically.</p>
<p>It will be easier to explain the <code>ggplot</code> syntax in the context of specific graph types, so let’s create a bar chart for species.</p>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-53-1.png" width="672"></div>
<p>We’ll walk through this syntax step by step.</p>
<ul>
<li>The first argument of the <code>ggplot</code> command is the name of the tibble, in this case, <code>penguins</code>.</li>
<li>Next we define the aesthetics using <code>aes</code> and parentheses. Inside the parentheses, we assign any variables we want to plot to aesthetics of the graph. For this analysis, we are only interested in the variable <code>species</code> and for a bar chart, the categorical variable typically goes on the x-axis. That’s why it says <code>x = species</code> inside the <code>aes</code> argument.</li>
<li>Finally, <code>ggplot</code> needs to know what kind of graph we want. Graph types are called “geoms” in the <code>ggplot</code> world, and <code><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar()</a></code> tells <code>ggplot</code> to add a “bar chart layer”. Adding a layer is accomplished by literally typing a plus sign.</li>
</ul>
<p>This can be modified somewhat to give proportions (relative frequencies) on the y-axis instead of counts. Unfortunately, the <code>ggplot</code> syntax is not very transparent here. My recommendation is to copy and paste the code below if you need to make a relative frequency bar chart in the future, making the necessary changes to the tibble and variable names, of course.</p>
<div class="sourceCode" id="cb72"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">..prop..</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-54-1.png" width="672"></div>
<p>These bar charts are the graphical analogues of a frequency table and a relative frequency table, respectively.</p>
<div id="exercise-4" class="section level5 unnumbered">
<h5>Exercise 4<a class="anchor" aria-label="anchor" href="#exercise-4"><i class="fas fa-link"></i></a>
</h5>
<p>In a sentence or two at most, describe the distribution of species in this data set.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>What about pie charts? Just. Don’t.</p>
<p>Seriously. Pie charts suck.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;&lt;a href="https://medium.com/the-mission/to-pie-charts-3b1f57bcb34a" class="uri"&gt;https://medium.com/the-mission/to-pie-charts-3b1f57bcb34a&lt;/a&gt;&lt;/p&gt;'><sup>7</sup></a></p>
</div>
</div>
<div id="categorical-summarizing-two" class="section level2" number="3.10">
<h2>
<span class="header-section-number">3.10</span> Summarizing two categorical variables<a class="anchor" aria-label="anchor" href="#categorical-summarizing-two"><i class="fas fa-link"></i></a>
</h2>
<p>A table summarizing two categorical variables is called a <em>contingency table</em> (or pivot table, or cross-tabulation, or probably several other terms as well).</p>
<p>For example, we might pose the following question: is the distribution of sex among penguins in our data more or less balanced across the three species?</p>
<p>When we work with two variables, typically we think of one variable as <em>response</em> and the other as <em>predictor</em>. The response variable is usually the variable of main interest. A predictor variable is another attribute that might predict or explain more about the response variable.</p>
<p>For example, our question is concerned with the sex distribution of penguins. We could create a relative frequency table of sex alone to see if male and female penguins are balanced in the data. In fact, you did that very thing above and saw that, indeed, there were roughly equal numbers of male and female penguins. But is that still true when we divide up the data into the three groups representing the separate species?</p>
<p>Two variables are called <em>associated</em> when there is a relationship between them. For example, if sex and species were associated, then the distribution of sex would change depending on the species. Maybe one species of penguin had more females and another had fewer females. Our prediction of the sex distribution would change based on the value of the predictor variable <code>species</code>.</p>
<p>On the other hand, two variables that are not associated are called <em>independent</em>. Independent variables are not related. If the sex distribution were the same across all species, then knowledge of the species would not change our predictions about the sex of a penguin. It wouldn’t matter because there was no relationship between sex and species.</p>
<p>Most research questions that involve two or more variables are fundamentally questions of whether a response variable is associated with one or more predictor variables, or whether they are independent.</p>
<p>Let’s check the contingency table. The <code>tabyl</code> command will place the first variable listed across the rows and the second one listed down the columns. It doesn’t make any difference which variable is where, but to have a consistent rule on which we can rely, <strong>let’s always list the response variable first</strong>.</p>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="va">sex</span>, <span class="va">species</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"73","3":"34","4":"58"},{"1":"male","2":"73","3":"34","4":"61"},{"1":"NA","2":"6","3":"0","4":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Each column is a group, and our question is whether the distribution of sexes in each column is similar.</p>
<div id="exercise-5" class="section level5 unnumbered">
<h5>Exercise 5<a class="anchor" aria-label="anchor" href="#exercise-5"><i class="fas fa-link"></i></a>
</h5>
<p>Counts can be misleading. For example, there are 73 female Adelie penguins, but only 34 female Chinstrap penguins. Does that mean that Adelie penguins are more likely to be female than Chinstrap penguins? Why or why not?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>A more fair way to compare across columns is to create relative frequencies. We can do this with a slightly different <code>adorn</code> command. The following code says that we want to compute column proportions (yes, I know the command is called <code>adorn_percentages</code>, but these are proportions):</p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="va">sex</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span><span class="st">"col"</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["dbl"],"align":["right"]},{"label":["Chinstrap"],"name":[3],"type":["dbl"],"align":["right"]},{"label":["Gentoo"],"name":[4],"type":["dbl"],"align":["right"]}],"data":[{"1":"female","2":"0.48026316","3":"0.5","4":"0.46774194"},{"1":"male","2":"0.48026316","3":"0.5","4":"0.49193548"},{"1":"NA","2":"0.03947368","3":"0.0","4":"0.04032258"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>If we actually want percentages, we need one more line of code. This command—<code>adorn_pct_formatting</code>—is the same as we used before with frequency tables.</p>
<div class="sourceCode" id="cb75"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/janitor/man/tabyl.html">tabyl</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="va">sex</span>, <span class="va">species</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_percentages.html">adorn_percentages</a></span><span class="op">(</span><span class="st">"col"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/janitor/man/adorn_pct_formatting.html">adorn_pct_formatting</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["sex"],"name":[1],"type":["fct"],"align":["left"]},{"label":["Adelie"],"name":[2],"type":["chr"],"align":["left"]},{"label":["Chinstrap"],"name":[3],"type":["chr"],"align":["left"]},{"label":["Gentoo"],"name":[4],"type":["chr"],"align":["left"]}],"data":[{"1":"female","2":"48.0%","3":"50.0%","4":"46.8%"},{"1":"male","2":"48.0%","3":"50.0%","4":"49.2%"},{"1":"NA","2":"3.9%","3":"0.0%","4":"4.0%"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Now we can see that each column adds up to 100%. In other words, each species is now on equal footing, and only the distribution of sexes within each group matters.</p>
</div>
<div id="exercise-6a" class="section level5 unnumbered">
<h5>Exercise 6(a)<a class="anchor" aria-label="anchor" href="#exercise-6a"><i class="fas fa-link"></i></a>
</h5>
<p>What percentage of Adelie penguins are male? What percentage of Chinstrap penguins are male? What percentage of Gentoo penguins are male?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
<div id="exercise-6b" class="section level5 unnumbered">
<h5>Exercise 6(b)<a class="anchor" aria-label="anchor" href="#exercise-6b"><i class="fas fa-link"></i></a>
</h5>
<p>Does sex appear to be associated with species for the penguins in this data set? Or are these variables independent?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>The islands of Antarctica on which the penguins were observed and measured are recorded in the variable called <code>island</code>. Is the distribution of the three species of penguin the same (or similar) on the three islands?</p>
</div>
<div id="exercise-7a" class="section level5 unnumbered">
<h5>Exercise 7(a)<a class="anchor" aria-label="anchor" href="#exercise-7a"><i class="fas fa-link"></i></a>
</h5>
<p>Choosing which variables play the roles of response and predictor can be tricky. For the question above, with <code>species</code> and <code>island</code>, which is response and which is predictor?</p>
<p>One way to think about this is to ask the following two questions and see which one is closer to the question asked:</p>
<ul>
<li>Given information about the species, are you interested in which island the penguin lives on? If so, <code>species</code> is a predictor and <code>island</code> is response. (You are using <code>species</code> to predict <code>island</code>.)</li>
<li>Given information about the island, are you interested in the species of the penguin? If so, <code>island</code> is a predictor and <code>species</code> is response. (You are using <code>island</code> to predict <code>species</code>.)</li>
</ul>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
<div id="exercise-7b" class="section level5 unnumbered">
<h5>Exercise 7(b)<a class="anchor" aria-label="anchor" href="#exercise-7b"><i class="fas fa-link"></i></a>
</h5>
<p>Create a contingency table with percentages. List <code>species</code> first, followed by <code>island</code>. (Hey, that’s hint in case you need to go back and change your answer to part (a).)</p>
<div class=".{answer}">
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to create a contingency table with percentages.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-7c" class="section level5 unnumbered">
<h5>Exercise 7(c)<a class="anchor" aria-label="anchor" href="#exercise-7c"><i class="fas fa-link"></i></a>
</h5>
<p>Finally, comment on the association or independence of the two variables.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
</div>
<div id="categorical-graphing-two" class="section level2" number="3.11">
<h2>
<span class="header-section-number">3.11</span> Graphing two categorical variables<a class="anchor" aria-label="anchor" href="#categorical-graphing-two"><i class="fas fa-link"></i></a>
</h2>
<p>A somewhat effective way to display two categorical variables is with a side-by-side bar chart. Here is the <code>ggplot</code> code for the relationship between <code>sex</code> and <code>species</code>.</p>
<div class="sourceCode" id="cb77"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span>, x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-59-1.png" width="672"></div>
<p>This is somewhat different from the first <code>ggplot</code> example you saw above, so let’s take a moment to go through it.</p>
<ul>
<li>The first argument is the data frame <code>penguins</code>; no mystery there.</li>
<li>The second aesthetic <code>x = species</code> also makes a lot of sense. As <code>species</code> is our predictor variable—we’re using species to group the penguins, and then within each species, we’re interested in the sex distribution—<code>species</code> goes on the x-axis.</li>
<li>However, <code>sex</code> does not go on the y-axis! (This is a very common mistake for novices.) The y-axis of a bar chart is always a count or a proportion/percentage, so no variable should ever go on the y-axis of a bar chart. In that case, how does <code>sex</code> enter the picture? Through the use of color! The aesthetic <code>fill = sex</code> says to use the <code>sex</code> variable to shade or “fill” the bars with different colors. You’ll also notice that <code>ggplot</code> makes a legend automatically with the colors so you can see which color corresponds to which value (in this case, “female”, “male”, or “NA” for the missing data).</li>
</ul>
<p>Another unusual feature is the argument <code>position = "dodge"</code> in the <code>geom_bar</code> layer. Let’s see what happens if we remove it.</p>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span>, x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-60-1.png" width="672"></div>
<p>We get a stacked bar chart! This is another popular way of displaying two categorical variables, but we don’t tend to prefer it. Notice how difficult it is to compare the number of females across species; since there is no common baseline for the red segments of each bar, it is harder to determine which ones are bigger or smaller. (In this case, it’s fairly clear, but there are plenty of data sets for which the counts might be a lot closer.)</p>
<p>So let’s agree to use side-by-side bar charts. There is still one aspect of the side-by-side bar chart that is misleading, though. For example, the red bar for Adelie penguins is bigger than the red bar for Gentoo penguins. Does this mean Adelie penguins are more likely to be female?</p>
<p>This is the same issue we identified in an exercise above. To fix this problem, a better option here would be to use relative frequencies (i.e., proportions/percentages within each group) instead of counts on the y-axis. This is analogous to using proportions/percentages in a contingency table. Unfortunately, it is rather difficult to do this with <code>ggplot</code>. A compromise is available: by using <code>position = fill</code>, you can create a stacked bar chart that scales every group to 100%. Making comparisons across groups can still be hard, as explained above for any kind of stacked bar chart, but it works okay if there are only two categories in the response variable (as is almost the case with <code>sex</code> here, although the missing data distorts things a little at the bottom).</p>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span>, x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"fill"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-61-1.png" width="672"></div>
<p>This graph does correctly show that the sexes are pretty much equally balances across all three species.</p>
<div id="exercise-8a" class="section level5 unnumbered">
<h5>Exercise 8(a)<a class="anchor" aria-label="anchor" href="#exercise-8a"><i class="fas fa-link"></i></a>
</h5>
<p>Using <code>species</code> and <code>island</code>, create a side-by-side bar chart. Be careful, though, to change the sample code above to make sure <code>species</code> is now the response variable (using the <code>fill</code> aesthetic) and that <code>island</code> is the explanatory variable (using <code>x</code>). (Hey, that’s another hint to go back and look at the previous exercise and make sure you got part (a) right!)</p>
<div class="answer">
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to make a side-by-side bar chart.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-8b" class="section level5 unnumbered">
<h5>Exercise 8(b)<a class="anchor" aria-label="anchor" href="#exercise-8b"><i class="fas fa-link"></i></a>
</h5>
<p>Comment on the association or independence of the two variables.</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
</div>
<div id="categorical-recoding" class="section level2" number="3.12">
<h2>
<span class="header-section-number">3.12</span> Recoding factor variables<a class="anchor" aria-label="anchor" href="#categorical-recoding"><i class="fas fa-link"></i></a>
</h2>
<p>As mentioned earlier, there are situations where a categorical variable is not recorded in R as a factor variable. Let’s look at the <code>year</code> variable:</p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">$</span><span class="va">year</span><span class="op">)</span></span></code></pre></div>
<pre><code>##  int [1:344] 2007 2007 2007 2007 2007 2007 2007 2007 2007 2007 ...</code></pre>
<p>These appear as integers. Yes, years are whole numbers, but why might this variable be treated as categorical data and not numerical data?</p>
<div id="exercise-9a" class="section level5 unnumbered">
<h5>Exercise 9(a)<a class="anchor" aria-label="anchor" href="#exercise-9a"><i class="fas fa-link"></i></a>
</h5>
<p>Use the <code>tabyl</code> command to create a frequency table for <code>year</code>.</p>
<div class="answer">
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to make a frequency table for year.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-9b" class="section level5 unnumbered">
<h5>Exercise 9(b)<a class="anchor" aria-label="anchor" href="#exercise-9b"><i class="fas fa-link"></i></a>
</h5>
<p>Why is <code>year</code> better thought of as categorical data and not numerical data (at least for this data set—we’re not claiming years should always be treated as categorical)?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>While the <code>tabyl</code> command seemed to work just fine with the <code>year</code> data in integer format, there are other commands that will not work so well. For example, <code>ggplot</code> often fails to do the right thing when a categorical variable is coded as a number. Therefore, we need a way to change numerically coded variables to factors.</p>
<p>The code below uses a command called <code>mutate</code> that takes an old variable and creates a new variable. (You’ll learn more about this command in a later chapter. For now, you can just copy and paste this code if you need it again.) The name of the new variable can be anything we want; we’ll just call it <code>year_fct</code>. Then the real work is being done by the <code>as_factor</code> command that concerts the numeric <code>year</code> variable into a factor variable.</p>
<p>Observe the effect below:</p>
<div class="sourceCode" id="cb84"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="va">penguins</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>year_fct <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">year</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 344
## Columns: 9
## $ species           &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
## $ island            &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgerse…
## $ bill_length_mm    &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, …
## $ bill_depth_mm     &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, …
## $ flipper_length_mm &lt;int&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186…
## $ body_mass_g       &lt;int&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, …
## $ sex               &lt;fct&gt; male, female, female, NA, female, male, female, male…
## $ year              &lt;int&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…
## $ year_fct          &lt;fct&gt; 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007, 2007…</code></pre>
</div>
<div id="exercise-10a" class="section level5 unnumbered">
<h5>Exercise 10(a)<a class="anchor" aria-label="anchor" href="#exercise-10a"><i class="fas fa-link"></i></a>
</h5>
<p>Make a contingency table of the species measured in each year using counts. Use the <code>species</code> variable first, followed by the new factor variable <code>year_fct</code>. (Think about why that order makes sense. <strong>We will always list the response variable first so that the categories of interest will be the rows and the groups will be the columns.</strong>)</p>
<div class="answer">
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to make a contingency table for species and year with counts.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-10b" class="section level5 unnumbered">
<h5>Exercise 10(b)<a class="anchor" aria-label="anchor" href="#exercise-10b"><i class="fas fa-link"></i></a>
</h5>
<p>Make a contingency table of the species measured in each year using column percentages (<em>not</em> proportions). (Again, be sure to use the new factor variable <code>year_fct</code>, not the old variable <code>year</code>.)</p>
<div class="answer">
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to make a contingency table for species and year with percentages.</span></span></code></pre></div>
</div>
</div>
<div id="exercise-10c" class="section level5 unnumbered">
<h5>Exercise 10(c)<a class="anchor" aria-label="anchor" href="#exercise-10c"><i class="fas fa-link"></i></a>
</h5>
<p>How similar or dissimilar are the distributions of species across the three years of the study?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
</div>
</div>
<div id="categorical-pub" class="section level2" number="3.13">
<h2>
<span class="header-section-number">3.13</span> Publication-ready graphics<a class="anchor" aria-label="anchor" href="#categorical-pub"><i class="fas fa-link"></i></a>
</h2>
<p>Let’s go back to the first relative frequency bar chart from this chapter.</p>
<div class="sourceCode" id="cb88"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">..prop..</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-68-1.png" width="672"></div>
<p>The variable name <code>species</code> is already informative, but the y-axis is labeled with “prop”. Also note that this graph could use a title. We can do all this with <code>labs</code> (for labels). Observe:</p>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">..prop..</span>, group <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Distribution of species"</span>,</span>
<span>         y <span class="op">=</span> <span class="st">"Proportion"</span>,</span>
<span>         x <span class="op">=</span> <span class="st">"Species"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-69-1.png" width="672"></div>
<div id="exercise-11" class="section level5 unnumbered">
<h5>Exercise 11<a class="anchor" aria-label="anchor" href="#exercise-11"><i class="fas fa-link"></i></a>
</h5>
<p>Modify the following side-by-side bar chart by adding a title and labels for both the fill variable and the x-axis variable. (Hint: you can use <code>fill = sex</code> inside the <code>labs</code> command just like you used <code>title</code>, <code>y</code>, and <code>x</code>.)</p>
<div class="answer">
<div class="sourceCode" id="cb90"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Modify the following side-by-side bar chart by adding a title and </span></span>
<span><span class="co"># labels for both the x-axis and the fill variable.</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguins</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">sex</span>, x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"dodge"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-70-1.png" width="672"></div>
</div>
</div>
</div>
<div id="categorical-summary" class="section level2" number="3.14">
<h2>
<span class="header-section-number">3.14</span> Plotting summary data<a class="anchor" aria-label="anchor" href="#categorical-summary"><i class="fas fa-link"></i></a>
</h2>
<p>Everything we did above was summarizing <em>raw data</em>; that is, the data consisted of all the observations for each individual penguin. Often, though, when you find data out in the wild, that data will be summarized into a table already and you may not have access to the raw data.</p>
<p>For example, let’s suppose that you found some data online, but it looked like this:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>species</th>
<th>count</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Adelie</td>
<td>152</td>
</tr>
<tr class="even">
<td>Chinstrap</td>
<td>68</td>
</tr>
<tr class="odd">
<td>Gentoo</td>
<td>124</td>
</tr>
</tbody>
</table></div>
<p>This raises two questions:</p>
<ol style="list-style-type: decimal">
<li>How would you get this data into R?</li>
<li>How would you plot the data?</li>
</ol>
<p>To answer the first question, we show you how to create your own tibble. Here is the syntax:</p>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguin_species_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span></span>
<span>    species <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span><span class="op">)</span>,</span>
<span>    count <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">152</span>, <span class="fl">68</span>, <span class="fl">124</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">penguin_species_table</span></span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["species"],"name":[1],"type":["chr"],"align":["left"]},{"label":["count"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Adelie","2":"152"},{"1":"Chinstrap","2":"68"},{"1":"Gentoo","2":"124"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Basically, the <code>tibble</code> command creates a new tibble. Then each column of data must be entered manually as a “vector” using the <code>c</code> to group all the data values together for each column. Be careful about the placement of quotation marks, commas, and parentheses.</p>
<p>Once we have our summary data, we want to make a bar chart. But this won’t work:</p>
<div class="sourceCode" id="cb92"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguin_species_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-72-1.png" width="672"></div>
<div id="exercise-12" class="section level5 unnumbered">
<h5>Exercise 12<a class="anchor" aria-label="anchor" href="#exercise-12"><i class="fas fa-link"></i></a>
</h5>
<p>Explain what went wrong with the previous command? Why does <code>ggplot</code> think that each species has count 1?</p>
<div class="answer">
<p>Please write up your answer here.</p>
</div>
<hr>
<p>Instead, we need to use <code>geom_col</code>. This works a lot like <code>geom_bar</code> except that it also requires a <code>y</code> value in its aesthetics to force the command to look for the counts in some other variable in the data.</p>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">penguin_species_table</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>, y <span class="op">=</span> <span class="va">count</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_col</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="intro_stats_files/figure-html/unnamed-chunk-73-1.png" width="672"></div>
</div>
<div id="exercise-13a" class="section level5 unnumbered">
<h5>Exercise 13(a)<a class="anchor" aria-label="anchor" href="#exercise-13a"><i class="fas fa-link"></i></a>
</h5>
<p>Use the <code>tabyl</code> command to create a frequency table for <code>island</code>.</p>
<div class="answer">
<div class="sourceCode" id="cb94"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to create a frequency table for island</span></span></code></pre></div>
</div>
</div>
<div id="exercise-13b" class="section level5 unnumbered">
<h5>Exercise 13(b)<a class="anchor" aria-label="anchor" href="#exercise-13b"><i class="fas fa-link"></i></a>
</h5>
<p>Use the <code>tibble</code> command to create a new tibble manually that contains the frequency data for the <code>island</code> variable. It should have two columns, one called <code>island</code> and the other called <code>count</code>. Name it <code>penguin_island_table</code>.</p>
<div class="answer">
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to create a tibble with frequency data for island</span></span></code></pre></div>
</div>
</div>
<div id="exercise-13c" class="section level5 unnumbered">
<h5>Exercise 13(c)<a class="anchor" aria-label="anchor" href="#exercise-13c"><i class="fas fa-link"></i></a>
</h5>
<p>Use <code>ggplot</code> with <code>geom_col</code> to create a bar chart for island.</p>
<div class="answer">
<div class="sourceCode" id="cb96"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Add code here to create a bar chart for island</span></span></code></pre></div>
</div>
</div>
</div>
<div id="categorical-conclusion" class="section level2" number="3.15">
<h2>
<span class="header-section-number">3.15</span> Conclusion<a class="anchor" aria-label="anchor" href="#categorical-conclusion"><i class="fas fa-link"></i></a>
</h2>
<p>You can summarize a single categorical variable using a frequency table. For only one categorical variable, a graph is usually overkill, but if you really want a graph, the bar chart is the best option. Both raw counts and proportions/percentages can be useful.</p>
<p>We use contingency tables to summarize two categorical variables. Unless groups are of equal size, raw counts can be incredibly misleading here. You should include proportions/percentages to be able to compare the distributions across groups. If the proportions/percentages are roughly the same, the variables are more likely to be independent, whereas if the proportions/percentages are different, there may be an association between the variables. For graphing, the best choice is usually a side-by-side bar chart. A stacked bar chart will also work, especially if using relative frequencies on the y-axis, but it can be hard to compare across groups when the response variable has three or more categories.</p>
<p>Sometimes we come across categorical data that is recorded using numbers. Many R commands will not work properly if they expect factors and receive numbers, so we use the <code>mutate</code> command to create a new variable along with <code>as_factor</code> to convert the numbers to categories.</p>
<p>Sometimes we come across summary data instead of raw data. We can then manually create tibbles with that summary data and use <code>geom_col</code> instead of <code>geom_bar</code> to graph it.</p>
</div>
<div id="categorical-prep" class="section level2" number="3.16">
<h2>
<span class="header-section-number">3.16</span> Preparing and submitting your assignment<a class="anchor" aria-label="anchor" href="#categorical-prep"><i class="fas fa-link"></i></a>
</h2>
<ol style="list-style-type: decimal">
<li>From the “Run” menu, select “Restart R and Run All Chunks”.</li>
<li>Deal with any code errors that crop up. Repeat steps 1–-2 until there are no more code errors.</li>
<li>Spell check your document by clicking the icon with “ABC” and a check mark.</li>
<li>Hit the “Preview” button one last time to generate the final draft of the <code>.nb.html</code> file.</li>
<li>Proofread the HTML file carefully. If there are errors, go back and fix them, then repeat steps 1–5 again.</li>
</ol>
<p>If you have completed this chapter as part of a statistics course, follow the directions you receive from your professor to submit your assignment.</p>

</div>
</div>













  <div class="chapter-nav">
<div class="prev"><a href="rmark.html"><span class="header-section-number">2</span> Using R Markdown</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li>
<a class="nav-link" href="#categorical"><span class="header-section-number">3</span> Categorical data</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#functions-introduced-in-this-chapter-2">Functions introduced in this chapter:</a></li></ul>
</li>
<li><a class="nav-link" href="#categorical-intro"><span class="header-section-number">3.1</span> Introduction</a></li>
<li><a class="nav-link" href="#categorical-download"><span class="header-section-number">3.2</span> Download the R notebook file</a></li>
<li><a class="nav-link" href="#categorical-restart"><span class="header-section-number">3.3</span> Restart R and run all chunks</a></li>
<li><a class="nav-link" href="#categorical-load"><span class="header-section-number">3.4</span> Load packages</a></li>
<li><a class="nav-link" href="#categorical-data"><span class="header-section-number">3.5</span> Categorical data</a></li>
<li><a class="nav-link" href="#categorical-factor"><span class="header-section-number">3.6</span> Factor variables</a></li>
<li><a class="nav-link" href="#categorical-summarizing-one"><span class="header-section-number">3.7</span> Summarizing one categorical variable</a></li>
<li><a class="nav-link" href="#categorical-graphing-one"><span class="header-section-number">3.8</span> Graphing one categorical variable</a></li>
<li><a class="nav-link" href="#categorical-ggplot"><span class="header-section-number">3.9</span> ggplot</a></li>
<li><a class="nav-link" href="#categorical-summarizing-two"><span class="header-section-number">3.10</span> Summarizing two categorical variables</a></li>
<li><a class="nav-link" href="#categorical-graphing-two"><span class="header-section-number">3.11</span> Graphing two categorical variables</a></li>
<li><a class="nav-link" href="#categorical-recoding"><span class="header-section-number">3.12</span> Recoding factor variables</a></li>
<li><a class="nav-link" href="#categorical-pub"><span class="header-section-number">3.13</span> Publication-ready graphics</a></li>
<li><a class="nav-link" href="#categorical-summary"><span class="header-section-number">3.14</span> Plotting summary data</a></li>
<li><a class="nav-link" href="#categorical-conclusion"><span class="header-section-number">3.15</span> Conclusion</a></li>
<li><a class="nav-link" href="#categorical-prep"><span class="header-section-number">3.16</span> Preparing and submitting your assignment</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/VectorPosse/intro_stats/blob/main/03-categorical_data-web.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/VectorPosse/intro_stats/edit/main/03-categorical_data-web.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Introduction to Statistics: an integrated textbook and workbook using R</strong>" was written by Sean Raleigh, Westminster College (Salt Lake City, UT). It was last built on 2022-07-28.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
